create tablespace tstcc datafile 'C:\oraclexe\app\oracle\oradata\XE\tstcc.DBF' SIZE 100M;

create user sgf identified by sgf default tablespace tstcc;

grant dba to sgf;

CREATE TABLE ESTADO(
IDUF INTEGER NOT NULL PRIMARY KEY,
DSUF VARCHAR(20) NOT NULL,
DSSIGLA VARCHAR(2)NOT NULL);

CREATE TABLE CIDADE(
IDCIDADE INTEGER NOT NULL PRIMARY KEY,
IDUF INTEGER NOT NULL,
DSCIDADE VARCHAR(20) NOT NULL,
FOREIGN KEY (IDUF) REFERENCES ESTADO(IDUF));

CREATE TABLE PESSOA(
IDPESSOA INTEGER NOT NULL PRIMARY KEY,
DSPESSOA VARCHAR(20) NOT NULL,
DTNASC VARCHAR(10));

CREATE TABLE ENDERECO(
IDPESSOA INTEGER NOT NULL,
TPENDERECO VARCHAR(20) NOT NULL,
DSLOGRADOURO VARCHAR(20) NOT NULL,
DSNUMERO VARCHAR(20) NOT NULL,
DSBAIRRO VARCHAR(20) NOT NULL,
NRCEP VARCHAR(8) NOT NULL,
DSCOMPLEMENTO VARCHAR(20) NOT NULL,
IDCIDADE INTEGER NOT NULL,
FOREIGN KEY (IDPESSOA) REFERENCES PESSOA (IDPESSOA),
FOREIGN KEY (IDCIDADE) REFERENCES CIDADE (IDCIDADE));

 CREATE TABLE TELEFONE(
 IDPESSOA INTEGER NOT NULL,
 TPFONE VARCHAR(20) NOT NULL,
 NRFONE VARCHAR(11) NOT NULL,
 FOREIGN KEY (IDPESSOA) REFERENCES PESSOA (IDPESSOA));
 
 CREATE TABLE RELACAOPESSOA(
 IDPESSOA INTEGER NOT NULL,
 TPRELACAO VARCHAR(20) NOT NULL, 
 DTCOMEMORACAO VARCHAR(10),
 TPCOMEMORACAO VARCHAR(20),
 IDSEQUENCIA INTEGER NOT NULL,
 DSNOME VARCHAR(20),
 FOREIGN KEY (IDPESSOA) REFERENCES PESSOA (IDPESSOA));

 CREATE TABLE CADASTROTELA(
    IDTELA INTEGER NOT NULL PRIMARY KEY,
    DSTELA VARCHAR(20) NOT NULL);

 CREATE TABLE NIVEL(
   IDNIVEL INTEGER NOT NULL,
   DSNINEL VARCHAR(20) NOT NULL,
   IDTELA INTEGER NOT NULL,
   PRIMARY KEY(IDNIVEL, IDTELA),
   FOREIGN KEY(IDTELA) REFERENCES CADASTROTELA (IDTELA));

CREATE TABLE USUARIO(
DSUSUARIO VARCHAR(20)NOT NULL UNIQUE,
DSSENHA VARCHAR(20) NOT NULL,
IDNIVEL INTEGER NOT NULL,
FOREIGN KEY(IDNIVEL) REFERENCES NIVEL (IDNIVEL));

CREATE TABLE PESSOAJURIDICA(
IDPESSOA INTEGER NOT NULL,
NRCNPJ VARCHAR(20) NOT NULL,
RZSOCIAL VARCHAR(20) NOT NULL,
INSCESTADUAL VARCHAR(20),
FOREIGN KEY (IDPESSOA) REFERENCES PESSOA (IDPESSOA));

CREATE TABLE PESSOAFISICA(
IDPESSOA INTEGER NOT NULL,
NRCPF VARCHAR(11) NOT NULL,
NRRG VARCHAR(8) NOT NULL,
TPSEXO VARCHAR(2),
FOREIGN KEY (IDPESSOA) REFERENCES PESSOA (IDPESSOA));

CREATE TABLE FORNECEDOR(
IDPESSOA INTEGER NOT NULL,
DTCADASTRO VARCHAR(10) NOT NULL,
TPSITUACAO VARCHAR(2) NOT NULL,
VLLIMITE NUMERIC NOT NULL,
TPPESSOA VARCHAR(2) NOT NULL,
DSEMAIL VARCHAR(20) NOT NULL,
FOREIGN KEY (IDPESSOA) REFERENCES PESSOA (IDPESSOA));


CREATE TABLE FUNCIONARIO(
IDPESSOA INTEGER NOT NULL,
DTCADASTRO VARCHAR(10) NOT NULL,
DTDEMISSAO VARCHAR(10) NOT NULL,
TPSITUACAO VARCHAR(2) NOT NULL,
VLSALARIO NUMERIC NOT NULL,
LOGIN VARCHAR(20) NOT NULL,
TPPESSOA VARCHAR(2) NOT NULL,
FOREIGN KEY (IDPESSOA) REFERENCES PESSOA (IDPESSOA));


CREATE TABLE CLIENTE(
IDPESSOA INTEGER NOT NULL,
DTCADASTRO VARCHAR(10) NOT NULL,
TPCLIENTE VARCHAR(2) NOT NULL,
TPSITUACAO VARCHAR(2) NOT NULL,
FOREIGN KEY (IDPESSOA) REFERENCES PESSOA (IDPESSOA));

CREATE TABLE FAMILIA(
IDFAMILIA INTEGER NOT NULL PRIMARY KEY,
DSFAMILIA VARCHAR(20) NOT NULL);

CREATE TABLE PRODUTO(
IDPRODUTO INTEGER NOT NULL PRIMARY KEY,
IDFAMILIA INTEGER NOT NULL,
DSPRODUTO VARCHAR(20) NOT NULL,
DTCOMPRA VARCHAR(10) NOT NULL,
TPMATERIA VARCHAR(1) NOT NULL,
FOREIGN KEY (IDFAMILIA) REFERENCES FAMILIA (IDFAMILIA));

CREATE TABLE PRODUTOSFORNECEDOR(
IDPRODUTO INTEGER NOT NULL,
IDFORNECEDOR INTEGER NOT NULL,
IDSEQUENCIA INTEGER NOT NULL,
PRIMARY KEY (IDPRODUTO, IDFORNECEDOR),
FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO),
FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR (IDPESSOA));

CREATE TABLE FORMAPGTO(
IDFORMAPGTO INTEGER NOT NULL PRIMARY KEY,
DSFROMAPGTO VARCHAR(20) NOT NULL,
TPSITUACAO INTEGER NOT NULL,
NRINTERVALO INTEGER NOT NULL,
QTDPARCELA INTEGER NOT NULL);

CREATE TABLE COMPOSICAO(
IDPRODUTO INTEGER NOT NULL,
IDPROD INTEGER NOT NULL,
QTDPRODUTO NUMERIC NOT NULL,
PRIMARY KEY (IDPRODUTO, IDPROD),
FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO(IDPRODUTO),
FOREIGN KEY (IDPROD) REFERENCES PRODUTO(IDPRODUTO));

CREATE TABLE TIPOMOVTO(
IDTPMOVTO INTEGER NOT NULL PRIMARY KEY,
MOVESTOQUE VARCHAR(1) NOT NULL,
MOVFINANCEIRO VARCHAR(1) NOT NULL,
TPMOVTO VARCHAR(20) NOT NULL,
DSMVTO VARCHAR(20) NOT NULL);

CREATE TABLE COMPRA(
IDCOMPRA INTEGER NOT NULL PRIMARY KEY,
DTVENDA VARCHAR(10),
IDFORNECEDOR INTEGER NOT NULL,
IDFORMAPGTO INTEGER NOT NULL,
FOREIGN KEY (IDFORNECEDOR) REFERENCES FORNECEDOR (IDPESSOA),
FOREIGN KEY (IDFORMAPGTO) REFERENCES FORMAPGTO(IDFORMAPGTO));

CREATE TABLE ITENSCOMPRA(
IDITENSCOMRPA INTEGER NOT NULL PRIMARY KEY,
IDCOMPRA INTEGER NOT NULL,
IDPRODUTO INTEGER NOT NULL,
QTDPRODUTO INTEGER NOT NULL,
VLPRODUTO NUMERIC NOT NULL,
FOREIGN KEY (IDCOMPRA) REFERENCES COMPRA (IDCOMPRA),
FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO));

CREATE TABLE MOVTOPRODUTO(
IDMOVTOPRODUTO INTEGER NOT NULL PRIMARY KEY,
IDCOMPRA INTEGER NOT NULL,
IDITENSCOMPRA INTEGER NOT NULL,
DTATUALIZA VARCHAR(10) NOT NULL,
INENTRADA VARCHAR(5)NOT NULL,
QTDPRODUTO INTEGER NOT NULL,
FOREIGN KEY (IDCOMPRA) REFERENCES COMPRA (IDCOMPRA),
FOREIGN KEY (IDITENSCOMPRA) REFERENCES ITENSCOMPRA(IDITENSCOMPRA));

CREATE TABLE VENDA(
IDVENDA INTEGER NOT NULL PRIMARY KEY,
DTVENDA VARCHAR(10),
IDCLIENTE INTEGER NOT NULL,
IDFORMAPGTO INTEGER NOT NULL,
IDMOVTOPRODUTO INTEGER NOT NULL,
FOREIGN KEY (IDCLIENTE) REFERENCES CLIENTE (IDPESSOA),
FOREIGN KEY (IDFORMAPGTO) REFERENCES FORMAPGTO(IDFORMAPGTO),
FOREIGN KEY (IDMOVTOPRODUTO) REFERENCES MOVTOPRODUTO (IDMOVTOPRODUTO));


CREATE TABLE ITENSVENDA(
IDITENSVENDA INTEGER NOT NULL PRIMARY KEY,
IDVENDA INTEGER NOT NULL,
IDPRODUTO INTEGER NOT NULL,
QTDPRODUTO INTEGER NOT NULL,
VLPRODUTO NUMERIC NOT NULL,
FOREIGN KEY (IDVENDA) REFERENCES VENDA (IDVENDA),
FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO));

CREATE TABLE PRECOVENDA(
IDPRECOVENDA INTEGER NOT NULL PRIMARY KEY,
IDPRODUTO INTEGER NOT NULL,
VLVENDA NUMERIC NOT NULL,
DTALTERECAO VARCHAR(10) NOT NULL,
FOREIGN KEY (IDPRODUTO) REFERENCES PRODUTO (IDPRODUTO));

CREATE TABLE CONTASPAGAR(
IDCONTASPAGAR INTEGER NOT NULL PRIMARY KEY,
IDCOMPRA INTEGER NOT NULL,
DTPAGAR VARCHAR(10) NOT NULL,
VLPAGAR NUMERIC NOT NULL,
IDPARCELA INTEGER NOT NULL,
FOREIGN KEY (IDCOMPRA) REFERENCES COMPRA(IDCOMPRA));

CREATE TABLE CONTASRECEBER(
IDCONTASRECEBER INTEGER NOT NULL PRIMARY KEY,
IDVENDA INTEGER NOT NULL,
DTRECEBER VARCHAR(10) NOT NULL,
VLRECEBER NUMERIC NOT NULL,
IDPARCELA INTEGER NOT NULL,
FOREIGN KEY (IDVENDA) REFERENCES VENDA(IDVENDA));

CREATE TABLE PAGAMENTO(
IDPAGAMENTO INTEGER NOT NULL PRIMARY KEY,
IDCONTASPAGAR INTEGER NOT NULL,
VLPAGO NUMERIC NOT NULL,
TPPAGO VARCHAR(20) NOT NULL,
FOREIGN KEY (IDCONTASPAGAR) REFERENCES CONTASPAGAR (IDCONTASPAGAR));

